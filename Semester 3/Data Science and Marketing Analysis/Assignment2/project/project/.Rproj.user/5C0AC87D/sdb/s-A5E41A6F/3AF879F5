{
    "collab_server" : "",
    "contents" : "#################### Load Training and Validation Set ####################################\n#clear workspace\nrm(list = ls())\n#set working directory\nsetwd(\"~/Desktop/Kuliah/Semester 3/Data Science and Marketing Analysis/Assignment2/project/project/final_code\")\n#load library\nlibrary(dplyr)\n#load training set\nx.train  <- read.csv(\"datasets/trainingset.csv\",header=TRUE)\n#load evaluation set\nx.evaluate <- read.csv(\"datasets/evaluationset.csv\",header=TRUE)\n\n#convert categorical data to factor\nx.train  <- x.train %>%\n  mutate(gender = as.factor(gender)) %>% \n  mutate(subcategory = as.factor(subcategory)) %>% \n  mutate(articletype = as.factor(articletype)) %>%\n  mutate(SaleString = as.factor(SaleString))\n\nx.evaluate  <- x.evaluate %>%\n  mutate(gender = as.factor(gender)) %>% \n  mutate(subcategory = as.factor(subcategory)) %>% \n  mutate(articletype = as.factor(articletype)) %>%\n  mutate(SaleString = as.factor(SaleString))\n\n#create a dataframe to add the performance of each model\nmachinelearning.properties <- data.frame(Predictor=character(),\n                                         TDL = double(),\n                                         GiniIndex = double(),\n                                         TimeElapsed= double(),\n                                         PercCorrect = double())\n\nmakeLiftPlot <- function(Prediction, Evaluate, ModelName){\n  iPredictionsSorted <- sort(Prediction,index.return=T,decreasing=T)[2]$ix \n  CustomersSorted <- Evaluate$SaleString[iPredictionsSorted] \n  SumSaleReal<- sum(Evaluate$SaleString == \"Buy\") \n  CustomerCumulative=seq(nrow(Evaluate))/nrow(Evaluate) \n  SaleCumulative=apply(matrix(CustomersSorted==\"Buy\"),2,cumsum)/SumSaleReal \n  ProbTD = sum(CustomersSorted[1:floor(nrow(Evaluate)*.1)]==\"Buy\")/floor(nrow(Evaluate)*.1) \n  ProbOverall = SumSaleReal / nrow(Evaluate) \n  TDL = ProbTD / ProbOverall\n  GINI = sum((SaleCumulative-CustomerCumulative)/(t(matrix(1,1,nrow(Evaluate))-CustomerCumulative)),na.rm=T)/nrow(Evaluate)\n  plot(CustomerCumulative,SaleCumulative,type=\"l\",main=paste(\"Lift curve of\", ModelName),xlab=\"Cumulative fraction of customers (sorted by predicted sale probability)\",ylab=\"Cumulative fraction of buyers\")\n  lines(c(0,1),c(0,1),col=\"blue\",type=\"l\",pch=22, lty=2)\n  legend(.66,.2,c(\"According to model\",\"Random selection\"),cex=0.8,  col=c(\"black\",\"blue\"), lty=1:2)\n  text(0.15,1,paste(\"TDL = \",round(TDL,2), \"; GINI = \", round(GINI,2) ))\n  return(data.frame(TDL,GINI))\n}\n\ngetMachineLearningProperties <- function(predictorname,machinelearningoutput){\n  return (data.frame(Predictor = predictorname, TDL = machinelearningoutput$TDL, GiniIndex = machinelearningoutput$GINI,\n                                                                             TimeElapsed = machinelearningoutput$TimeElapsed,\n                                                                             PercCorrect = machinelearningoutput$PercCorrect))\n} \n\nBaseFormula <- as.formula(SaleString ~ views + remove + carts + birthyear + startyear + numbersearches + avgprice + TG_avg_temp +SQ_sunshine+ gender + subcategory + articletype) \nBaseFormula1 <- as.formula(IsSale ~  views + remove + carts + birthyear + startyear + numbersearches + avgprice + TG_avg_temp +SQ_sunshine+ gender + subcategory + articletype)\n\nx.train$SaleStringWithoutConvertingToFactor <- ifelse(x.train$IsSale==1,\"Buy\",\"NotBuy\")\nx.evaluate$SaleStringWithoutConvertingToFactor <- ifelse(x.evaluate$IsSale==1,\"Buy\",\"NotBuy\")\n\nx.train <- x.train %>% select(views,remove,carts,birthyear,startyear,numbersearches,avgprice,TG_avg_temp,SQ_sunshine,gender,subcategory,articletype,SaleString,IsSale,SaleStringWithoutConvertingToFactor)\nx.evaluate <- x.evaluate %>% select(views,remove,carts,birthyear,startyear,numbersearches,avgprice,TG_avg_temp,SQ_sunshine,gender,subcategory,articletype,SaleString,IsSale,SaleStringWithoutConvertingToFactor)\n\n\n",
    "created" : 1509297161887.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1867851573",
    "id" : "3AF879F5",
    "lastKnownWriteTime" : 1509306401,
    "last_content_update" : 1509306401392,
    "path" : "~/Desktop/Kuliah/Semester 3/Data Science and Marketing Analysis/Assignment2/project/project/final_code/03_new_loadingdataset.R",
    "project_path" : "final_code/03_new_loadingdataset.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}